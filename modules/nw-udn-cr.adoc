//module included in the following assembly:
//
// *networking/multiple_networks/understanding-user-defined-networks.adoc

:_mod-docs-content-type: PROCEDURE
[id="nw-udn-cr_{context}"]
= Creating a UserDefinedNetwork custom resource

The following procedure sets up a user-defined network that is namespace scoped.

.Prerequisites
* You must

.Procedure

[NOTE]
====
If any cluster default networked pods exist before the user-defined network is created, any further pods created in this namespace will return an error message: `What_is_this`.
====

. Create a request for a user-defined network:

.. Create a yaml file, such as `my-udn-request.yaml`, to define your request with content like the following example:

[source, yaml]
----
apiVersion: policy.networking.k8s.io/v1alpha1
kind: UserDefinedNetwork
metadata:
name: <example_network> # <1>
namespace: <my_namespace>
spec:
topology: Layer2 # <2>
role: Primary # <3>
mtu: 9000 <4>
subnets: ["10.0.0.0/24"] # <5>
excludeSubnets: ["10.0.0.0/26"] <6>
JoinSubnets: <7>
IPAMLifecycle: Persistent # <8>
----
<1> Name of your `UserDefinedNetwork` resource. This should not be `default`.
<2> The layer you wish to create the network on. The `topology` field accepts values of `Layer2` and `Layer3`.
<3> Specifies `Primary` or `Secondary`. `Primary` is the only `role` specification supported in {product-version}.
<4> The maximum transmission units (MTU) the default value is `1400`.
<5> Specifies the subnet to be used for the network across the cluster. Supports both IPv6 and dual-stack. For example, `192.168.100.0/24`,`2001:DBB::/64`. If omitted the network only provides `Layer2` communication and you must configure IP addresses.
<6> Specifies the CIDR range to remove from the assignable IP address pool excluding them from being assigned to pods.
<7> Specifies the `subnets` used inside the OVN-Kubernetes network topology. If omitted, the OVN-Kubernetes network plugin assigns one, which is subject to change over time.
<8> Specifies the IP address management system (IPAM). The `Persistent` value specifies that workloads have persistent IP addresses. Assigned by the container network interface (CNI) and used by OVN-Kubernetes to program pod IP addresses. You must not change this for pod annotations.


.. Apply your request by running the following command:
+
[source,terminal]
----
$ oc apply -f my-udn-request.yaml
----

.Verify that your request is successful by running the following command:
[source, terminal]
----
$ oc
----


