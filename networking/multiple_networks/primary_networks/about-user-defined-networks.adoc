:_mod-docs-content-type: ASSEMBLY
[id="about-user-defined-networks"]
= About user-defined networks
include::_attributes/common-attributes.adoc[]
:context: about-user-defined-networks

toc::[]

:featurename: `UserDefinedNetwork`
include::snippets/technology-preview.adoc[]

Before the implementation of user-defined networks (UDN), the OVN-Kubernetes CNI plugin for {product-title} only supported a Layer 3 topology on the primary or _main_ network. Due to Kubernetes design principles: all pods are attached to the main network, all pods communicate with each other by their IP addresses, and inter-pod traffic is restricted according to network policy.

UDN improves the flexibility and segmentation capabilities of the default Layer 3 topology for a Kubernetes pod network by enabling custom Layer 2 and Layer 3 network segments, where all these segments are isolated by default. These segments act as either primary or secondary networks for container pods and virtual machines that use the default OVN-Kubernetes CNI plugin. UDNs enable a wide range of network architectures and topologies, enhancing network flexibility, security, and performance.

[NOTE]
====
Support for the Localnet topology on both primary and secondary networks will be added in a future version of {product-title}.
====

A cluster administrator can use a UDN to create and define primary or secondary networks that span multiple namespaces at the cluster level by leveraging the `ClusterUserDefinedNetwork` custom resource (CR). Additionally, a cluster administrator or a cluster user can use a UDN to define secondary networks at the namespace level with the `UserDefinedNetwork` CR.

The following diagram shows four cluster namespaces, where each namespace has a single assigned user-defined network (UDN), and each UDN has an assigned custom subnet for its pod IP allocations. The OVN-Kubernetes handles any overlapping UDN subnets. Without using the Kubernetes network policy, a pod attached to a UDN can communicate with other pods in that UDN. By default, these pods are isolated from communicating with pods that exist in other UDNs. For microsegmentation, you can apply network policy within a UDN. You can assign one or more UDNs to a namespace, with a limitation of only one primary UDN to a namespace, and one or more namespaces to a UDN.

.Namespace isolation using a UserDefinedNetwork CR
image::527-OpenShift-UDN-isolation-012025.png[The namespace isolation concept in a user-defined network (UDN)]

////
Unlike NADs, which are only namespaced scope, UDNs offer administrators the ability to create and define additional networks spanning multiple namespaces at the cluster level by leveraging the `ClusterUserDefinedNetwork` custom resource (CR).

UDNs also offer both administrators and users the ability to define additional networks at the namespace level with the `UserDefinedNetwork` CR.
////

The following sections further emphasize the benefits and limitations of user-defined networks, the best practices when creating a `UserDefinedNetwork` custom resource, how to create the custom resource, and additional configuration details that might be relevant to your deployment.

// Looks like this may be out for 4.17, but in for 4.18 as of 8/19/24
//. Ingress and egress support
//+
//* **Support for ingress and egress traffic**: Cluster ingress and egress traffic is supported for both primary and secondary networks.
//* **Support for ingress and egress features**: User-defined networks support support the following ingress and egress features:
//+
//** EgressQoS
//** EgressService
//** EgressIP
//** Load balancer and NodePort services, as well as services with external IPs.

//benefits of UDN
include::modules/nw-udn-benefits.adoc[leveloffset=+1]

//Limitations that users should consider for UDN.
include::modules/nw-udn-limitations.adoc[leveloffset=+1]

// Layer 2 and layer 3 topologies
include::modules/nw-udn-l2-l3.adoc[leveloffset=+1]

//Best practices for using UDN.
include::modules/nw-udn-best-practices.adoc[leveloffset=+1]

//How to implement the UDN API by using the CLI.
include::modules/nw-udn-cr.adoc[leveloffset=+1]

[role="_additional-resources"]
.Additional resources
* xref:../../../authentication/using-rbac.adoc#authorization-overview_using-rbac[Default cluster roles]

//Explanation of optional config details
include::modules/nw-udn-additional-config-details.adoc[leveloffset=+1]

//Support matrix for UDN
//include::modules

//Examples for Layer2 and Layer3
//include::modules/nw-udn-examples.adoc[leveloffset=+2]

//[role="_additional-resources"]
//== Additional resources
// * xr3f../virtual docs that point to live migration of vms for 4.18's GA.